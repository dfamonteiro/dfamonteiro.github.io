<!DOCTYPE html>
<html lang="en">

<head>
  <title>
  Solving the mathematics of Factorio Quality: Pure Recycler Loop · Daniel&#39;s blog
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="Daniel Monteiro">
<meta name="description" content="The pure recycler loop is the simplest possible way to grind for legendary items, making it the logical next step of our quality analysis journey. Armed with the knowledge we gained from the previous post of this series, we&rsquo;re going to calculate the efficiency of this quality grinding method and do some statistical analysis of how the production of quality items is affected by the quality chance of the recyclers.">
<meta name="keywords" content="blog,developer,personal,engineering">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Solving the mathematics of Factorio Quality: Pure Recycler Loop">
  <meta name="twitter:description" content="The pure recycler loop is the simplest possible way to grind for legendary items, making it the logical next step of our quality analysis journey. Armed with the knowledge we gained from the previous post of this series, we’re going to calculate the efficiency of this quality grinding method and do some statistical analysis of how the production of quality items is affected by the quality chance of the recyclers.">

<meta property="og:url" content="https://dfamonteiro.com/posts/factorio-pure-recycler-loop/">
  <meta property="og:site_name" content="Daniel&#39;s blog">
  <meta property="og:title" content="Solving the mathematics of Factorio Quality: Pure Recycler Loop">
  <meta property="og:description" content="The pure recycler loop is the simplest possible way to grind for legendary items, making it the logical next step of our quality analysis journey. Armed with the knowledge we gained from the previous post of this series, we’re going to calculate the efficiency of this quality grinding method and do some statistical analysis of how the production of quality items is affected by the quality chance of the recyclers.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-12-15T23:42:06+00:00">
    <meta property="article:modified_time" content="2024-12-15T23:42:06+00:00">
    <meta property="article:tag" content="Maths">
    <meta property="article:tag" content="Programming">
    <meta property="article:tag" content="Factorio Quality">




<link rel="canonical" href="https://dfamonteiro.com/posts/factorio-pure-recycler-loop/">


<link rel="preload" href="https://dfamonteiro.com/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="https://dfamonteiro.com/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="https://dfamonteiro.com/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="https://dfamonteiro.com/css/coder.min.ed30115a76cdaa62f2229e973d5b1c89b2d3dd4b1d9c07a729baad06aa3b0cbe.css" integrity="sha256-7TARWnbNqmLyIp6XPVscibLT3UsdnAenKbqtBqo7DL4=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="https://dfamonteiro.com/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css" integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/svg+xml" href="https://dfamonteiro.com/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="https://dfamonteiro.com/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="https://dfamonteiro.com/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="https://dfamonteiro.com/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://dfamonteiro.com/images/apple-touch-icon.png">

<link rel="manifest" href="https://dfamonteiro.com/site.webmanifest">
<link rel="mask-icon" href="https://dfamonteiro.com/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="https://dfamonteiro.com/">
      Daniel&#39;s blog
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="https://dfamonteiro.com/posts/">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="https://dfamonteiro.com/about/">About</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="https://dfamonteiro.com/posts/factorio-pure-recycler-loop/">
              Solving the mathematics of Factorio Quality: Pure Recycler Loop
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2024-12-15T23:42:06Z">
                December 15, 2024
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              10-minute read
            </span>
          </div>
          
          
          <div class="tags">
  <i class="fa-solid fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="https://dfamonteiro.com/tags/maths/">Maths</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="https://dfamonteiro.com/tags/programming/">Programming</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="https://dfamonteiro.com/tags/factorio-quality/">Factorio Quality</a>
    </span></div>

        </div>
      </header>

      <div class="post-content">
        
        <script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
</script>
<p>The pure recycler loop is the simplest possible way to grind for legendary items, making it the logical next step of our quality analysis journey. Armed with the knowledge we gained from the <a href="https://dfamonteiro.com/posts/factorio-quality-1/" >previous post</a> of <a href="https://dfamonteiro.com/tags/factorio-quality/" >this series</a>, we&rsquo;re going to calculate the efficiency of this quality grinding method and do some statistical analysis of how the production of quality items is affected by the quality chance of the recyclers.</p>
<div style="text-align:center">
    <img src="https://dfamonteiro.com/images/Pure-Recycler-Loop.webp" alt="Example of a pure recycler loop setup"/>
    <figcaption> Example of a pure recycler loop setup</figcaption>
</div>
<h2 id="unrolling-the-infinite-loop">
  Unrolling the infinite loop
  <a class="heading-link" href="#unrolling-the-infinite-loop">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Before we start crafting production matrices, we need to figure out a way to deal with the outputs of the system getting fed back into the system:</p>
<pre style="text-align:center" class="mermaid">
---
title: Conceptual model of a pure recycler loop
config:
  theme: dark
---
flowchart LR
    A[Item Input] --> B[Recycler]
    B -->|Q<=4| B
    B -->|Q=5| C[Q5 Storage]
</pre>
<p>Notice how I&rsquo;m using &ldquo;Q&rdquo; as a shorthand for the level of quality of the items. Q=1 means common items and Q=5 means legendary items.</p>
<p>Finding a way to get around loops is never easy. Fortunately for us, we can take a page from the compiler optimization book and unroll the loop:</p>
<pre style="text-align:center" class="mermaid">
---
title: Conceptual model of a pure recycler loop, unrolled into an infinite line
config:
  theme: dark
---
flowchart TD
    A[Item Input] --> R0
    R0 -->|Q<=4| R1
    R0 -->|Q=5| END[Q5 Storage]

    R1 -->|Q=5| END
    R1 -->|Q<=4| R2

    R2 -->|Q=5| END
    R2 -->|Q<=4|R3

    R3 -->|Q=5| END
    R3 -->|Q<=4|Rn[Rn]

    Rn -->|Q=5| END
    Rn -->|Q<=4|Rn1[Rn+1]

    Rn1 -->|Q=5| END
    Rn1 -->|Q<=4|Rn2[...]
</pre>
<p>Doing this trick does get rid of the loop and gives us a more workable linear problem. Unfortunately, this comes at a cost of having to handle the recycler line being theoretically infinite. In practice, the system runs out of items very quickly because 3/4 of the items are voided in every step of the recycler chain and the items that don&rsquo;t get voided will eventually turn into legendary items and be removed from the system.</p>
<h2 id="calculating-the-production-rate-of-the-infinite-recycler-line">
  Calculating the production rate of the infinite recycler line
  <a class="heading-link" href="#calculating-the-production-rate-of-the-infinite-recycler-line">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>In order to get the total production of Q5 items (the fifth value of vector $\vec{s}$), we have to add the Q5 production of every single recycler in the infinite chain:</p>
<p>$$ \vec{s} = \vec{s_1} + \vec{s_2} + \vec{s_3} + \vec{s_4} + \vec{s_n} + \vec{s_{n+1}} + &hellip;$$</p>
<p>$\vec{s_x}$ is the state of the system after recycler $x$ and can be represented in the following manner<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>:</p>
<p>$$ \vec{s_x} = \vec{s_{x-1}} \cdot R_q \newline
\vec{s_1} = \vec{f}$$</p>
<p>$\vec{f}$ represents the input into the system, let&rsquo;s assume assume that it will be a single belt of Q1 items <nobr>($\vec{f}= \begin{bmatrix} 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \end{bmatrix}$)</nobr>. $R_q$ is a recycler production matrix with quality chance $q$, and a production ratio of 0.25 for Q1-Q4 and 0 for Q5 to simulate the legendary items being removed from the system and put into a box. Let&rsquo;s write a function to help us create these recycler matrices:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">recycler_matrix</span>(
</span></span><span style="display:flex;"><span>        quality_chance : float,
</span></span><span style="display:flex;"><span>        quality_to_keep : int <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>,
</span></span><span style="display:flex;"><span>        production_ratio : float <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.25</span>) <span style="color:#f92672">-&gt;</span> np<span style="color:#f92672">.</span>ndarray:
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Returns a matrix of a recycler with quality chance `quality_chance`
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    that saves any item of quality level `quality_to_keep` or above.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Args:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        quality_chance (float): Quality chance of the recyclers (in %).
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        quality_to_keep (int): Minimum quality level of the items to be removed from the system
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            (By default only removes legendaries).
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        production_ratio (float): Productivity ratio of the recyclers (0.25 by default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Returns:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        np.ndarray: Standard production matrix.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">assert</span> quality_chance <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">assert</span> type(quality_to_keep) <span style="color:#f92672">==</span> int <span style="color:#f92672">and</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;=</span> quality_to_keep <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">assert</span> production_ratio <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    recycling_rows <span style="color:#f92672">=</span> quality_to_keep <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    saving_rows <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">-</span> recycling_rows
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> custom_production_matrix(
</span></span><span style="display:flex;"><span>        [(quality_chance, production_ratio)] <span style="color:#f92672">*</span> recycling_rows <span style="color:#f92672">+</span> [(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>)] <span style="color:#f92672">*</span> saving_rows
</span></span><span style="display:flex;"><span>    )
</span></span></code></pre></div><p>For the remainder of this chapter, let&rsquo;s assume that we&rsquo;re working with a quality chance $q$ of 10%:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(recycler_matrix(<span style="color:#ae81ff">10</span>))
</span></span></code></pre></div><p>$$ R_{10} = \begin{bmatrix}
0.225 &amp; 0.0225 &amp; 0.00225 &amp; 0.000225 &amp; 0.000025 \\
0     &amp; 0.225  &amp; 0.0225  &amp; 0.00225  &amp; 0.00025 \\
0     &amp; 0      &amp; 0.225   &amp; 0.0225   &amp; 0.0025 \\
0     &amp; 0      &amp; 0       &amp; 0.225    &amp; 0.025 \\
0     &amp; 0      &amp; 0       &amp; 0        &amp; 0 \\
\end{bmatrix}$$</p>
<p>We have everything we need to compute $\vec{s}$, but instead of calculating a neverending sum of recursive functions, allow me to present a simpler alternative with a simple <code>for</code>-loop<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">recycler_loop</span>(
</span></span><span style="display:flex;"><span>        input_vector : Union[np<span style="color:#f92672">.</span>array, float],
</span></span><span style="display:flex;"><span>        quality_chance : float,
</span></span><span style="display:flex;"><span>        quality_to_keep : int <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>,
</span></span><span style="display:flex;"><span>        production_ratio : float <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.25</span>) <span style="color:#f92672">-&gt;</span> np<span style="color:#f92672">.</span>ndarray:
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Returns a vector with values for each quality level that mean different things,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    depending on whether that quality is kept or recycled.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Returns:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        np.ndarray: Vector with values for each quality level.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> type(input_vector) <span style="color:#f92672">in</span> (float, int):
</span></span><span style="display:flex;"><span>        input_vector <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([input_vector, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    result_flows <span style="color:#f92672">=</span> [input_vector]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>        result_flows<span style="color:#f92672">.</span>append(
</span></span><span style="display:flex;"><span>            result_flows[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">@</span> recycler_matrix(
</span></span><span style="display:flex;"><span>                quality_chance,
</span></span><span style="display:flex;"><span>                quality_to_keep,
</span></span><span style="display:flex;"><span>                production_ratio
</span></span><span style="display:flex;"><span>            )
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> sum(result_flows[<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> result_flows[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1E-10</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># There&#39;s nothing left in the system</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> sum(result_flows)
</span></span></code></pre></div><h3 id="basic-analysis-of-the-function-recycler_loops-output">
  Basic analysis of the function <code>recycler_loop</code>&rsquo;s output
  <a class="heading-link" href="#basic-analysis-of-the-function-recycler_loops-output">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Let&rsquo;s see what happens when we call this function:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>recycler_loop(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>)
</span></span></code></pre></div><p>$$\vec{s} = \begin{bmatrix} 1.29032258 &amp; 0.03746098 &amp; 0.00483367 &amp; 0.0006237 &amp; 0.0000693 \end{bmatrix}$$</p>
<p>And here we have our first big result: if you feed a belt of common items into a recycler loop with T3 normal modules, you&rsquo;ll get an output of 0.0000693 belts of legendary items, which means that this specific setup has an efficiency of 0.00693%. If we invert this number, we get the number of normal items required to craft one legendary item, which is 14430&hellip; yikes, that&rsquo;s quite a bit.</p>
<p>What happens if we use legendary quality modules? Well, in that case the quality chance increases to 24.8%, the efficiency of the recycler loop setup increases to 0.03667% and the number of normal items required to craft a legendary item decreases to 2726.91<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>: a &gt;5x improvement but still quite inefficient when compared when compared to other quality grinding methods.</p>
<p>Finally, we need to understand what that the other 4 values in the return vector mean: they represent the <em>internal</em> flow of the system when it reaches a steady state. If we add the first 4 values of the vector we get 1.332844, which is the number of belts that the recycler loop needs to support in order for 1 input belt to be fully consumed. Should we wish to get the production rates for lower qualities, we would need to set the <code>quality_to_keep</code> parameter to a lower value and run the <code>recycler_loop</code> function specifically for that quality level.</p>
<h2 id="statistical-analysis">
  Statistical analysis
  <a class="heading-link" href="#statistical-analysis">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Now that pure recyler loops have been completely figured out, all that remains to be done is to create some helpful charts.</p>
<h3 id="number-of-normal-items-needed-to-craft-a-legendary-item">
  Number of normal items needed to craft a legendary item
  <a class="heading-link" href="#number-of-normal-items-needed-to-craft-a-legendary-item">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>In the previous chapter we calculated how many normal items were needed for a legendary item for the qualities of 10% and 24.8%. Let&rsquo;s do the same calculation for all possible quality chances:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>indices <span style="color:#f92672">=</span> list(range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">25</span>)) <span style="color:#f92672">+</span> [<span style="color:#ae81ff">24.8</span>]
</span></span><span style="display:flex;"><span>ratios <span style="color:#f92672">=</span> [float(<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>recycler_loop(<span style="color:#ae81ff">1</span>, i)[<span style="color:#ae81ff">4</span>]) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> indices]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>indices<span style="color:#e6db74">=}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>ratios<span style="color:#e6db74">=}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># indices=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 24.8]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ratios=[275537.6188099327, 126925.19559177945, 78182.11949565915, 54324.731972068614, 40366.883416794, 31320.37503248879, 25052.454970936447, 20500.388421332522, 17076.449879282212, 14430.015645433099, 12339.492586876928, 10658.332376632781, 9285.998982461751, 8151.406056252092, 7203.000009109451, 6402.577635616764, 5721.297803873242, 5137.031906270301, 4632.558279121844, 4194.304003533878, 3811.450711699854, 3475.287804518467, 3178.73735561973, 2916.000006871485, 2726.9095125910867]</span>
</span></span></code></pre></div><pre style="text-align:center" class="mermaid">
---
config:
  theme: dark
---
xychart-beta
    title "Normal items needed to craft a legendary item"
    x-axis "Quality chance (%)" [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 24.8]
    y-axis "Number of normal items" 0 --> 270000
    line [275537.6188099327, 126925.19559177945, 78182.11949565915, 54324.731972068614, 40366.883416794, 31320.37503248879, 25052.454970936447, 20500.388421332522, 17076.449879282212, 14430.015645433099, 12339.492586876928, 10658.332376632781, 9285.998982461751, 8151.406056252092, 7203.000009109451, 6402.577635616764, 5721.297803873242, 5137.031906270301, 4632.558279121844, 4194.304003533878, 3811.450711699854, 3475.287804518467, 3178.73735561973, 2916.000006871485, 2726.9095125910867]
</pre>
<pre style="text-align:center" class="mermaid">
---
config:
  theme: dark
---
xychart-beta
    title "Normal items needed to craft a legendary item (starting from 10%)"
    x-axis "Quality chance (%)" [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 24.8]
    y-axis "Number of normal items" 0 --> 14000
    line [14430.015645433099, 12339.492586876928, 10658.332376632781, 9285.998982461751, 8151.406056252092, 7203.000009109451, 6402.577635616764, 5721.297803873242, 5137.031906270301, 4632.558279121844, 4194.304003533878, 3811.450711699854, 3475.287804518467, 3178.73735561973, 2916.000006871485, 2726.9095125910867]
</pre>
<h3 id="efficiency-of-pure-recycler-loops-for-every-quality-level">
  Efficiency of pure recycler loops for every quality level
  <a class="heading-link" href="#efficiency-of-pure-recycler-loops-for-every-quality-level">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>In the same manner that we calculated the efficiency of the creation of legendary items, we can do the same for every quality level (except common, that would be always 100%) and quality chance. In the charts below, the lines are color-coded to match their quality level&rsquo;s color (green for common, blue for rare, etc).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>indices <span style="color:#f92672">=</span> list(range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">25</span>)) <span style="color:#f92672">+</span> [<span style="color:#ae81ff">24.8</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>uncommon  <span style="color:#f92672">=</span> [float(recycler_loop(<span style="color:#ae81ff">100</span>, i, <span style="color:#ae81ff">2</span>)[<span style="color:#ae81ff">1</span>]) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> indices]
</span></span><span style="display:flex;"><span>rare      <span style="color:#f92672">=</span> [float(recycler_loop(<span style="color:#ae81ff">100</span>, i, <span style="color:#ae81ff">3</span>)[<span style="color:#ae81ff">2</span>]) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> indices]
</span></span><span style="display:flex;"><span>epic      <span style="color:#f92672">=</span> [float(recycler_loop(<span style="color:#ae81ff">100</span>, i, <span style="color:#ae81ff">4</span>)[<span style="color:#ae81ff">3</span>]) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> indices]
</span></span><span style="display:flex;"><span>legendary <span style="color:#f92672">=</span> [float(recycler_loop(<span style="color:#ae81ff">100</span>, i, <span style="color:#ae81ff">5</span>)[<span style="color:#ae81ff">4</span>]) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> indices]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>uncommon<span style="color:#e6db74">=}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>rare<span style="color:#e6db74">=}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>epic<span style="color:#e6db74">=}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>legendary<span style="color:#e6db74">=}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># uncommon=[0.2990033222590812, 0.5960264900661364, 0.8910891089107843, 1.1842105263156755, 1.4754098360654597, 1.7647058823524755, 2.0521172638432112, 2.337662337661936, 2.621359223300609, 2.9032258064512915, 3.183279742764992, 3.461538461538218, 3.738019169328864, 4.012738853502352, 4.285714285713574, 4.556962025315852, 4.826498422712422, 5.094339622641082, 5.360501567397762, 5.624999999999703, 5.887850467289476, 6.149068322980344, 6.408668730649312, 6.666666666665972, 6.8719211822654165]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># rare=[0.030794362093117447, 0.06315512477518555, 0.09704930889121104, 0.13244459833784739, 0.16930932545002106, 0.2076124567472599, 0.24732357902985952, 0.28841288581532015, 0.3308511641057835, 0.3746097814774666, 0.4196606734833703, 0.4659763313603146, 0.5135297900350304, 0.5622946164139104, 0.6122448979586821, 0.6633552315329551, 0.7156007125153923, 0.7689569241719442, 0.8233999272802733, 0.8789062499997253, 0.9354528779803724, 0.9930172447040724, 1.0515772220562896, 1.111111111110377, 1.159425125578718]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># epic=[0.0031715123750366684, 0.006691933751003337, 0.010569726710900342, 0.014812882708795454, 0.0194289389860028, 0.02442499491135333, 0.02980772776570127, 0.035583407990068, 0.04175791391611173, 0.0483367459969256, 0.05532504055550809, 0.06272758306761636, 0.07054882099510452, 0.07879287618526323, 0.0874635568511152, 0.09656436914707982, 0.10609852835329592, 0.11606896968564748, 0.12647835873520066, 0.1373291015618632, 0.14862335444493466, 0.16036303330587975, 0.17254982281385564, 0.18518518518476199, 0.1956172933547551]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># legendary=[0.00036292684985614993, 0.0007878656366129634, 0.001279064838494827, 0.0018407822079469461, 0.002477278194905434, 0.003192809792284794, 0.003991624782162819, 0.004877956362181414, 0.005856018132670216, 0.006929999425940391, 0.008104060960091449, 0.009382330800525801, 0.010768900613177278, 0.012267822194231644, 0.013883104261852726, 0.015618709496127328, 0.017478551814108522, 0.019466493867471745, 0.02158634475090182, 0.02384185790990489, 0.02623672923728639, 0.02877459534805905, 0.03145903202229863, 0.03429355281117717, 0.0366715506144467]</span>
</span></span></code></pre></div><pre style="text-align:center" class="mermaid" id="pure-recycler-loop-efficiency-chart">
---
config:
  theme: dark
---
xychart-beta
    title "Efficiency of a pure recycler loop"
    x-axis "Quality chance (%)" [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 24.8]
    y-axis "Efficiency (%)" 0 --> 7
    line [0.2990033222590812, 0.5960264900661364, 0.8910891089107843, 1.1842105263156755, 1.4754098360654597, 1.7647058823524755, 2.0521172638432112, 2.337662337661936, 2.621359223300609, 2.9032258064512915, 3.183279742764992, 3.461538461538218, 3.738019169328864, 4.012738853502352, 4.285714285713574, 4.556962025315852, 4.826498422712422, 5.094339622641082, 5.360501567397762, 5.624999999999703, 5.887850467289476, 6.149068322980344, 6.408668730649312, 6.666666666665972, 6.8719211822654165]
    line [0.030794362093117447, 0.06315512477518555, 0.09704930889121104, 0.13244459833784739, 0.16930932545002106, 0.2076124567472599, 0.24732357902985952, 0.28841288581532015, 0.3308511641057835, 0.3746097814774666, 0.4196606734833703, 0.4659763313603146, 0.5135297900350304, 0.5622946164139104, 0.6122448979586821, 0.6633552315329551, 0.7156007125153923, 0.7689569241719442, 0.8233999272802733, 0.8789062499997253, 0.9354528779803724, 0.9930172447040724, 1.0515772220562896, 1.111111111110377, 1.159425125578718]
    line [0.0031715123750366684, 0.006691933751003337, 0.010569726710900342, 0.014812882708795454, 0.0194289389860028, 0.02442499491135333, 0.02980772776570127, 0.035583407990068, 0.04175791391611173, 0.0483367459969256, 0.05532504055550809, 0.06272758306761636, 0.07054882099510452, 0.07879287618526323, 0.0874635568511152, 0.09656436914707982, 0.10609852835329592, 0.11606896968564748, 0.12647835873520066, 0.1373291015618632, 0.14862335444493466, 0.16036303330587975, 0.17254982281385564, 0.18518518518476199, 0.1956172933547551]
    line [0.00036292684985614993, 0.0007878656366129634, 0.001279064838494827, 0.0018407822079469461, 0.002477278194905434, 0.003192809792284794, 0.003991624782162819, 0.004877956362181414, 0.005856018132670216, 0.006929999425940391, 0.008104060960091449, 0.009382330800525801, 0.010768900613177278, 0.012267822194231644, 0.013883104261852726, 0.015618709496127328, 0.017478551814108522, 0.019466493867471745, 0.02158634475090182, 0.02384185790990489, 0.02623672923728639, 0.02877459534805905, 0.03145903202229863, 0.03429355281117717, 0.0366715506144467]
</pre>
<pre style="text-align:center" class="mermaid" id="pure-recycler-loop-efficiency-chart-only-epic-and-legendary">
---
config:
  theme: dark
---
xychart-beta
    title "Efficiency of a pure recycler loop (only epic and legendary)"
    x-axis "Quality chance (%)" [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 24.8]
    y-axis "Efficiency (%)" 0 --> 0.25
    line [0.0031715123750366684, 0.006691933751003337, 0.010569726710900342, 0.014812882708795454, 0.0194289389860028, 0.02442499491135333, 0.02980772776570127, 0.035583407990068, 0.04175791391611173, 0.0483367459969256, 0.05532504055550809, 0.06272758306761636, 0.07054882099510452, 0.07879287618526323, 0.0874635568511152, 0.09656436914707982, 0.10609852835329592, 0.11606896968564748, 0.12647835873520066, 0.1373291015618632, 0.14862335444493466, 0.16036303330587975, 0.17254982281385564, 0.18518518518476199, 0.1956172933547551]
    line [0.00036292684985614993, 0.0007878656366129634, 0.001279064838494827, 0.0018407822079469461, 0.002477278194905434, 0.003192809792284794, 0.003991624782162819, 0.004877956362181414, 0.005856018132670216, 0.006929999425940391, 0.008104060960091449, 0.009382330800525801, 0.010768900613177278, 0.012267822194231644, 0.013883104261852726, 0.015618709496127328, 0.017478551814108522, 0.019466493867471745, 0.02158634475090182, 0.02384185790990489, 0.02623672923728639, 0.02877459534805905, 0.03145903202229863, 0.03429355281117717, 0.0366715506144467]
</pre>
<style>
#pure-recycler-loop-efficiency-chart svg[aria-roledescription="xychart"] g.line-plot-0 path {stroke: #3eec57 !important;}
#pure-recycler-loop-efficiency-chart svg[aria-roledescription="xychart"] g.line-plot-1 path {stroke: #2495ff !important;}
#pure-recycler-loop-efficiency-chart svg[aria-roledescription="xychart"] g.line-plot-2 path {stroke: #c400ff !important;}
#pure-recycler-loop-efficiency-chart svg[aria-roledescription="xychart"] g.line-plot-3 path {stroke: #ff9500 !important;}

#pure-recycler-loop-efficiency-chart-only-epic-and-legendary svg[aria-roledescription="xychart"] g.line-plot-0 path {stroke: #c400ff !important;}
#pure-recycler-loop-efficiency-chart-only-epic-and-legendary svg[aria-roledescription="xychart"] g.line-plot-1 path {stroke: #ff9500 !important;}
</style>
<h2 id="next-step-asteroid-chunk-recyclingpostsfactorio-recycling-asteroid-chunk-recycling">
  Next step: <a href="https://dfamonteiro.com/posts/factorio-recycling-asteroid-chunk-recycling/" ><strong>Asteroid Chunk Recycling</strong></a>
  <a class="heading-link" href="#next-step-asteroid-chunk-recyclingpostsfactorio-recycling-asteroid-chunk-recycling">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>I previously considered going straight to <a href="https://dfamonteiro.com/posts/factorio-recycler-assembler-loop/" >recycler-assembler loops</a> and tackle the final frontier of recycling<sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup> later. However, after thinking about it for bit, I concluded that asteroid chunk recycling is the logical next step for the series and builds elegantly on the analysis &amp; tools created in this blog post that were required to tackle pure recycling loops.</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>It does make sense that $\vec{s_x}$ is recursive. After all, if you want to know the state of the system after the 7th recycler, you need the state of the 6th recycler, which in turn needs the 5th recycler etc etc.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>Please note that I cut a big part of the <code>recycler_loop</code>&rsquo;s doc string to make it more readable in the context of this blogpost. If you want the full description of this function, please click <a href="https://github.com/dfamonteiro/blog/blob/main/Factorio%20Quality/pure_recycler_loop.py#L28C1-L57"  class="external-link" target="_blank" rel="noopener">here</a>.&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p>This is consistent with the results <a href="https://www.reddit.com/r/factorio/comments/1gxu6im/comment/lyjujzg/"  class="external-link" target="_blank" rel="noopener">other</a> <a href="https://youtu.be/O2QcGNIlFCk?si=rc4xe1xtAySzCEI7&amp;t=120"  class="external-link" target="_blank" rel="noopener">people</a> have been getting.&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p>Please pardon my lousy humor.&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

      </div>


      <footer>
        


        
        
        
        
        
        
        
      </footer>
    </article>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css"
    integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">
  
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js"
    integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js"
    integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
    onload="renderMathInElement(document.body,
      {
        delimiters: [
          {left: '$$', right: '$$', display:true},
          {left: '$', right: '$', display:false},
          {left: '\\(', right: '\\)', display: false},
          {left: '\\[', right: '\\]', display: true}
        ]
      }
    );"></script>
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
    2025
     Daniel Monteiro 
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="https://dfamonteiro.com/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  
  



  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>

</html>
